<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Property Master - Modern Interface</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1><i class="fas fa-building"></i> Property Master</h1>
            <p>Comprehensive property management system with modern interface</p>
        </div>

        <!-- Statistics Dashboard -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="totalProperties">125</div>
                <div class="stat-label">Total Properties</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="availableProperties">67</div>
                <div class="stat-label">Available</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="reservedProperties">31</div>
                <div class="stat-label">Reserved</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="soldProperties">27</div>
                <div class="stat-label">Sold</div>
            </div>
        </div>

        <!-- Tabs Navigation -->
        <div class="tabs">
            <button class="tab active" onclick="switchTab(event, 'property-form')">
                <i class="fas fa-plus-circle"></i> Add Property
            </button>
            <button class="tab" onclick="switchTab(event, 'property-list')">
                <i class="fas fa-list"></i> Property List
            </button>
            <button class="tab" onclick="switchTab(event, 'bulk-upload')">
                <i class="fas fa-upload"></i> Bulk Upload
            </button>
            <button class="tab" onclick="switchTab(event, 'analytics')">
                <i class="fas fa-chart-bar"></i> Analytics
            </button>
        </div>

        <!-- Property Form Tab -->
        <div id="property-form" class="tab-content active">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-home"></i> Property Information
                    </div>
                    <div class="card-actions">
                        <button class="btn btn-outline btn-sm" onclick="resetForm()">
                            <i class="fas fa-refresh"></i> Reset
                        </button>
                    </div>
                </div>

                <form id="propertyForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Property ID <span class="required">*</span></label>
                            <div class="input-group">
                                <i class="fas fa-tag input-group-icon"></i>
                                <input type="text" class="form-control" id="propertyId" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Property Name <span class="required">*</span></label>
                            <div class="input-group">
                                <i class="fas fa-home input-group-icon"></i>
                                <input type="text" class="form-control" id="propertyName" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Project <span class="required">*</span></label>
                            <select class="form-control" id="project" required>
                                <option value="">Select Project</option>
                                <option value="sunrise-heights">Sunrise Heights</option>
                                <option value="ocean-view">Ocean View Residences</option>
                                <option value="downtown-plaza">Downtown Plaza</option>
                                <option value="garden-city">Garden City</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Property Type <span class="required">*</span></label>
                            <select class="form-control" id="propertyType" required onchange="updateAttributes()">
                                <option value="">Select Type</option>
                                <option value="residential">Residential</option>
                                <option value="commercial">Commercial</option>
                                <option value="industrial">Industrial</option>
                                <option value="mixed">Mixed Use</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Building</label>
                            <div class="input-group">
                                <i class="fas fa-building input-group-icon"></i>
                                <input type="text" class="form-control" id="building" placeholder="e.g., Block A, Tower 1">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Floor</label>
                            <div class="input-group">
                                <i class="fas fa-layer-group input-group-icon"></i>
                                <input type="text" class="form-control" id="floor" placeholder="e.g., Ground, 1st, 2nd">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Unit Number</label>
                            <div class="input-group">
                                <i class="fas fa-door-open input-group-icon"></i>
                                <input type="text" class="form-control" id="unit" placeholder="e.g., A-G-001">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Area (Sq Ft) <span class="required">*</span></label>
                            <div class="input-group">
                                <i class="fas fa-ruler-combined input-group-icon"></i>
                                <input type="number" class="form-control" id="area" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Base Price <span class="required">*</span></label>
                            <div class="input-group">
                                <i class="fas fa-dollar-sign input-group-icon"></i>
                                <input type="number" class="form-control" id="price" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Price per Sq Ft</label>
                            <div class="input-group">
                                <i class="fas fa-calculator input-group-icon"></i>
                                <input type="number" class="form-control" id="pricePerSqFt" readonly>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Status</label>
                            <select class="form-control" id="status">
                                <option value="available">Available</option>
                                <option value="reserved">Reserved</option>
                                <option value="sold">Sold</option>
                                <option value="maintenance">Under Maintenance</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Bedrooms</label>
                            <select class="form-control" id="bedrooms">
                                <option value="">Select</option>
                                <option value="studio">Studio</option>
                                <option value="1">1 Bedroom</option>
                                <option value="2">2 Bedrooms</option>
                                <option value="3">3 Bedrooms</option>
                                <option value="4">4+ Bedrooms</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Bathrooms</label>
                            <input type="number" class="form-control" id="bathrooms" min="1" max="10">
                        </div>
                        
                        <div class="form-group">
                            <label>Parking Spaces</label>
                            <input type="number" class="form-control" id="parking" min="0" max="5">
                        </div>
                        
                        <div class="form-group">
                            <label>Balcony</label>
                            <select class="form-control" id="balcony">
                                <option value="">Select</option>
                                <option value="yes">Yes</option>
                                <option value="no">No</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Facing Direction</label>
                            <select class="form-control" id="facing">
                                <option value="">Select</option>
                                <option value="north">North</option>
                                <option value="south">South</option>
                                <option value="east">East</option>
                                <option value="west">West</option>
                                <option value="northeast">North-East</option>
                                <option value="northwest">North-West</option>
                                <option value="southeast">South-East</option>
                                <option value="southwest">South-West</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>View Type</label>
                            <select class="form-control" id="viewType">
                                <option value="">Select</option>
                                <option value="city">City View</option>
                                <option value="garden">Garden View</option>
                                <option value="pool">Pool View</option>
                                <option value="street">Street View</option>
                                <option value="courtyard">Courtyard View</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Furnished Status</label>
                            <select class="form-control" id="furnished">
                                <option value="">Select</option>
                                <option value="unfurnished">Unfurnished</option>
                                <option value="semi-furnished">Semi Furnished</option>
                                <option value="fully-furnished">Fully Furnished</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Effective From</label>
                            <input type="date" class="form-control" id="effectiveFrom">
                        </div>
                        
                        <div class="form-group">
                            <label>Effective To</label>
                            <input type="date" class="form-control" id="effectiveTo">
                        </div>
                        
                        <div class="form-group">
                            <label>Agent/Contact Person</label>
                            <input type="text" class="form-control" id="agent" placeholder="Agent name">
                        </div>
                        
                        <div class="form-group">
                            <label>Contact Number</label>
                            <input type="tel" class="form-control" id="contactNumber" placeholder="+1-234-567-8900">
                        </div>
                        
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" class="form-control" id="email" placeholder="agent@example.com">
                        </div>
                        
                        <div class="form-group">
                            <label>Description</label>
                            <textarea class="form-control" id="description" rows="3" placeholder="Property description..."></textarea>
                        </div>
                    </div>
                    
                    <div class="btn-group">
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-save"></i> Save Property
                        </button>
                        <button type="button" class="btn btn-primary" onclick="previewProperty()">
                            <i class="fas fa-eye"></i> Preview
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="exportProperty()">
                            <i class="fas fa-download"></i> Export
                        </button>
                        <button type="button" class="btn btn-outline" onclick="clearForm()">
                            <i class="fas fa-eraser"></i> Clear
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Property List Tab -->
        <div id="property-list" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-list"></i> Property Portfolio
                    </div>
                    <div class="card-actions">
                        <button class="btn btn-primary btn-sm" onclick="refreshList()">
                            <i class="fas fa-sync"></i> Refresh
                        </button>
                        <button class="btn btn-success btn-sm" onclick="exportList()">
                            <i class="fas fa-file-excel"></i> Export
                        </button>
                        <button class="btn btn-secondary btn-sm" onclick="importList()">
                            <i class="fas fa-file-import"></i> Import
                        </button>
                    </div>
                </div>
                
                <div class="search-bar">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="Search properties..." id="searchInput" oninput="filterProperties()">
                </div>
                
                <div class="filters">
                    <select id="statusFilter" class="form-control" onchange="filterByStatus()">
                        <option value="">All Status</option>
                        <option value="available">Available</option>
                        <option value="reserved">Reserved</option>
                        <option value="sold">Sold</option>
                    </select>
                    
                    <select id="typeFilter" class="form-control" onchange="filterByType()">
                        <option value="">All Types</option>
                        <option value="residential">Residential</option>
                        <option value="commercial">Commercial</option>
                        <option value="industrial">Industrial</option>
                    </select>
                </div>
                
                <div class="table-container">
                    <table class="table" id="propertyTable">
                        <thead>
                            <tr>
                                <th><input type="checkbox" id="selectAll" onchange="toggleSelectAll()"></th>
                                <th>Property ID</th>
                                <th>Name</th>
                                <th>Project</th>
                                <th>Type</th>
                                <th>Building</th>
                                <th>Unit</th>
                                <th>Area (Sq Ft)</th>
                                <th>Price</th>
                                <th>Status</th>
                                <th>Agent</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="propertyTableBody">
                            <tr>
                                <td><input type="checkbox" class="property-select"></td>
                                <td>P001</td>
                                <td>Sunrise Heights A-G-001</td>
                                <td>Sunrise Heights</td>
                                <td>Residential</td>
                                <td>Block A</td>
                                <td>A-G-001</td>
                                <td>1,200</td>
                                <td>$250,000</td>
                                <td><span class="status-badge status-available">Available</span></td>
                                <td>John Doe</td>
                                <td>
                                    <button class="btn btn-primary btn-sm" onclick="editProperty('P001')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-secondary btn-sm" onclick="viewProperty('P001')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn btn-danger btn-sm" onclick="deleteProperty('P001')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td><input type="checkbox" class="property-select"></td>
                                <td>P002</td>
                                <td>Ocean View B-1-002</td>
                                <td>Ocean View Residences</td>
                                <td>Residential</td>
                                <td>Block B</td>
                                <td>B-1-002</td>
                                <td>850</td>
                                <td>$180,000</td>
                                <td><span class="status-badge status-reserved">Reserved</span></td>
                                <td>Jane Smith</td>
                                <td>
                                    <button class="btn btn-primary btn-sm" onclick="editProperty('P002')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-secondary btn-sm" onclick="viewProperty('P002')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn btn-danger btn-sm" onclick="deleteProperty('P002')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td><input type="checkbox" class="property-select"></td>
                                <td>P003</td>
                                <td>Downtown Plaza C-2-003</td>
                                <td>Downtown Plaza</td>
                                <td>Commercial</td>
                                <td>Block C</td>
                                <td>C-2-003</td>
                                <td>1,500</td>
                                <td>$320,000</td>
                                <td><span class="status-badge status-sold">Sold</span></td>
                                <td>Mike Johnson</td>
                                <td>
                                    <button class="btn btn-primary btn-sm" onclick="editProperty('P003')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-secondary btn-sm" onclick="viewProperty('P003')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn btn-danger btn-sm" onclick="deleteProperty('P003')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="bulk-actions">
                    <button class="btn btn-primary" onclick="bulkEdit()">
                        <i class="fas fa-edit"></i> Bulk Edit
                    </button>
                    <button class="btn btn-danger" onclick="bulkDelete()">
                        <i class="fas fa-trash"></i> Bulk Delete
                    </button>
                    <button class="btn btn-success" onclick="bulkExport()">
                        <i class="fas fa-download"></i> Export Selected
                    </button>
                </div>
            </div>
        </div>

        <!-- Bulk Upload Tab -->
        <div id="bulk-upload" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-upload"></i> Bulk Upload Properties
                    </div>
                </div>
                
                <div class="upload-instructions">
                    <h3>Upload Instructions</h3>
                    <ul>
                        <li>Download the template file first</li>
                        <li>Fill in your property data in the template</li>
                        <li>Save as Excel (.xlsx) or CSV format</li>
                        <li>Upload the completed file</li>
                    </ul>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label>Property Master Upload</label>
                        <div class="upload-zone" onclick="document.getElementById('propertyFile').click()">
                            <div class="upload-icon">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <h3>Upload Property Master</h3>
                            <p>Drag and drop your Excel file here or click to browse</p>
                            <p class="upload-info">Supported formats: .xlsx, .xls, .csv</p>
                            <input type="file" id="propertyFile" accept=".xlsx,.xls,.csv" style="display: none;" onchange="handleFileUpload(this)">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Price List Upload</label>
                        <div class="upload-zone" onclick="document.getElementById('priceFile').click()">
                            <div class="upload-icon">
                                <i class="fas fa-dollar-sign"></i>
                            </div>
                            <h3>Upload Price List</h3>
                            <p>Drag and drop your pricing Excel file here or click to browse</p>
                            <p class="upload-info">Supported formats: .xlsx, .xls, .csv</p>
                            <input type="file" id="priceFile" accept=".xlsx,.xls,.csv" style="display: none;" onchange="handleFileUpload(this)">
                        </div>
                    </div>
                </div>
                
                <div class="upload-progress" id="uploadProgress" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-text" id="progressText">Uploading... 0%</div>
                </div>
                
                <div class="btn-group">
                    <button class="btn btn-primary">
                        <i class="fas fa-download"></i> Download Template
                    </button>
                    <button class="btn btn-success" onclick="processUpload()">
                        <i class="fas fa-check"></i> Process Upload
                    </button>
                    <button class="btn btn-secondary" onclick="validateData()">
                        <i class="fas fa-check-double"></i> Validate Data
                    </button>
                </div>
                
                <div class="upload-results" id="uploadResults">
                    <!-- Upload results will be displayed here -->
                </div>
            </div>
        </div>

        <!-- Analytics Tab -->
        <div id="analytics" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-chart-bar"></i> Property Analytics
                    </div>
                    <div class="card-actions">
                        <button class="btn btn-primary btn-sm" onclick="refreshAnalytics()">
                            <i class="fas fa-sync"></i> Refresh
                        </button>
                        <button class="btn btn-success btn-sm" onclick="exportAnalytics()">
                            <i class="fas fa-file-export"></i> Export Report
                        </button>
                    </div>
                </div>
                
                <div class="analytics-filters">
                    <select class="form-control" id="analyticsProject">
                        <option value="">All Projects</option>
                        <option value="sunrise-heights">Sunrise Heights</option>
                        <option value="ocean-view">Ocean View Residences</option>
                        <option value="downtown-plaza">Downtown Plaza</option>
                    </select>
                    
                    <select class="form-control" id="analyticsTimeframe">
                        <option value="month">This Month</option>
                        <option value="quarter">This Quarter</option>
                        <option value="year">This Year</option>
                        <option value="all">All Time</option>
                    </select>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number">$2.5M</div>
                        <div class="stat-label">Total Portfolio Value</div>
                        <div class="stat-change positive">+12.5%</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">87%</div>
                        <div class="stat-label">Occupancy Rate</div>
                        <div class="stat-change positive">+5.2%</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">$1,250</div>
                        <div class="stat-label">Avg Price per Sq Ft</div>
                        <div class="stat-change negative">-2.1%</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">15</div>
                        <div class="stat-label">Properties This Month</div>
                        <div class="stat-change positive">+8</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">$180K</div>
                        <div class="stat-label">Average Property Value</div>
                        <div class="stat-change neutral">0%</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">45</div>
                        <div class="stat-label">Days to Sell (Avg)</div>
                        <div class="stat-change positive">-7 days</div>
                    </div>
                </div>
                
                <div class="analytics-charts">
                    <div class="chart-container">
                        <h3>Property Distribution by Type</h3>
                        <div class="chart-placeholder" id="typeChart">
                            <i class="fas fa-chart-pie"></i>
                            <p>Chart will be rendered here</p>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <h3>Sales Trend (Last 12 Months)</h3>
                        <div class="chart-placeholder" id="salesChart">
                            <i class="fas fa-chart-line"></i>
                            <p>Chart will be rendered here</p>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <h3>Price Range Distribution</h3>
                        <div class="chart-placeholder" id="priceChart">
                            <i class="fas fa-chart-bar"></i>
                            <p>Chart will be rendered here</p>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <h3>Project Performance</h3>
                        <div class="chart-placeholder" id="projectChart">
                            <i class="fas fa-chart-area"></i>
                            <p>Chart will be rendered here</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">&times;</button>
            <div class="modal-header">
                <h2 id="modalTitle">Property Details</h2>
            </div>
            <div id="modalBody">
                <!-- Modal content will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification">
        <span id="notificationText"></span>
    </div>

    <!-- Loading Spinner -->
    <div id="loadingSpinner" class="loading-spinner">
        <div class="spinner"></div>
        <p>Processing...</p>
    </div>

    <script >

        // Property Master JavaScript

// Global variable
let properties = [
    {
        id: 'P001',
        name: 'Sunrise Heights A-G-001',
        project: 'Sunrise Heights',
        type: 'Residential',
        building: 'Block A',
        unit: 'A-G-001',
        area: 1200,
        price: 250000,
        status: 'available',
        bedrooms: 2,
        bathrooms: 2,
        agent: 'John Doe',
        facing: 'north',
        furnished: 'semi-furnished'
    },
    {
        id: 'P002',
        name: 'Ocean View B-1-002',
        project: 'Ocean View Residences',
        type: 'Residential',
        building: 'Block B',
        unit: 'B-1-002',
        area: 850,
        price: 180000,
        status: 'reserved',
        bedrooms: 1,
        bathrooms: 1,
        agent: 'Jane Smith',
        facing: 'east',
        furnished: 'unfurnished'
    },
    {
        id: 'P003',
        name: 'Downtown Plaza C-2-003',
        project: 'Downtown Plaza',
        type: 'Commercial',
        building: 'Block C',
        unit: 'C-2-003',
        area: 1500,
        price: 320000,
        status: 'sold',
        bedrooms: 0,
        bathrooms: 2,
        agent: 'Mike Johnson',
        facing: 'south',
        furnished: 'fully-furnished'
    }
];

let filteredProperties = [...properties];
let selectedProperties = [];

// DOM 
document.addEventListener('DOMContentLoaded', function() {
    initializeApp();
    bindEventListeners();
    updateStats();
    renderPropertyTable();
});

// Initialisation 
function initializeApp() {
    
    const today = new Date().toISOString().split('T')[0];
    const effectiveFromEl = document.getElementById('effectiveFrom');
    
    if (effectiveFromEl) effectiveFromEl.value = today;
    
    //  drag and drop
    initializeDragDrop();
    
    // Update price 
    const areaInput = document.getElementById('area');
    const priceInput = document.getElementById('price');
    const pricePerSqFtInput = document.getElementById('pricePerSqFt');
    
    if (areaInput && priceInput && pricePerSqFtInput) {
        [areaInput, priceInput].forEach(input => {
            input.addEventListener('input', function() {
                const area = parseFloat(areaInput.value) || 0;
                const price = parseFloat(priceInput.value) || 0;
                const pricePerSqFt = area > 0 ? (price / area).toFixed(2) : 0;
                pricePerSqFtInput.value = pricePerSqFt;
            });
        });
    }
}

// Bind Event Listeners
function bindEventListeners() {
    // Form submission
    const propertyForm = document.getElementById('propertyForm');
    if (propertyForm) {
        propertyForm.addEventListener('submit', handleFormSubmit);
    }
    
    // Search functionality
    const searchInput = document.getElementById('searchInput');
    if (searchInput) {
        searchInput.addEventListener('input', debounce(filterProperties, 300));
    }
}

// Tab Switching
function switchTab(event, tabName) {
    // Remove active class 
    document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
    
    // Add active class to clicked tab 
    event.target.classList.add('active');
    const tabContent = document.getElementById(tabName);
    if (tabContent) {
        tabContent.classList.add('active');
    }
    
    // Refresh data 
    if (tabName === 'analytics') {
        refreshAnalytics();
    }
}

// Form Handling
function handleFormSubmit(event) {
    event.preventDefault();
    
    const formData = collectFormData();
    
    // Validation
    if (!validateFormData(formData)) {
        showNotification('Please fill in all required fields', 'error');
        return;
    }
    
    showLoading();
    
    // Simulating call
    setTimeout(() => {
        hideLoading();
        
        //  editing existing property
        const existingIndex = properties.findIndex(p => p.id === formData.id);
        
        if (existingIndex !== -1) {
            properties[existingIndex] = formData;
            showNotification('Property updated successfully!', 'success');
        } else {
            properties.push(formData);
            showNotification('Property added successfully!', 'success');
        }
        
        updateStats();
        renderPropertyTable();
        resetForm();
    }, 1500);
}

function collectFormData() {
    return {
        id: document.getElementById('propertyId').value,
        name: document.getElementById('propertyName').value,
        project: document.getElementById('project').value,
        type: document.getElementById('propertyType').value,
        building: document.getElementById('building').value,
        floor: document.getElementById('floor').value,
        unit: document.getElementById('unit').value,
        area: parseFloat(document.getElementById('area').value) || 0,
        price: parseFloat(document.getElementById('price').value) || 0,
        pricePerSqFt: parseFloat(document.getElementById('pricePerSqFt').value) || 0,
        status: document.getElementById('status').value,
        bedrooms: document.getElementById('bedrooms').value,
        bathrooms: parseInt(document.getElementById('bathrooms').value) || 0,
        parking: parseInt(document.getElementById('parking').value) || 0,
        balcony: document.getElementById('balcony').value,
        facing: document.getElementById('facing').value,
        viewType: document.getElementById('viewType').value,
        furnished: document.getElementById('furnished').value,
        effectiveFrom: document.getElementById('effectiveFrom').value,
        effectiveTo: document.getElementById('effectiveTo').value,
        agent: document.getElementById('agent').value,
        contactNumber: document.getElementById('contactNumber').value,
        email: document.getElementById('email').value,
        description: document.getElementById('description').value
    };
}

function validateFormData(data) {
    return data.id && data.name && data.project && data.type && data.area && data.price;
}

// Property Table Management
function renderPropertyTable() {
    const tbody = document.getElementById('propertyTableBody');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    
    filteredProperties.forEach(property => {
        const row = createPropertyRow(property);
        tbody.appendChild(row);
    });
}

function createPropertyRow(property) {
    const row = document.createElement('tr');
    const statusClass = `status-${property.status}`;
    const formattedPrice = formatCurrency(property.price);
    
    row.innerHTML = `
        <td><input type="checkbox" class="property-select" data-id="${property.id}" onchange="togglePropertySelection('${property.id}')"></td>
        <td>${property.id}</td>
        <td>${property.name}</td>
        <td>${property.project}</td>
        <td>${property.type}</td>
        <td>${property.building || 'N/A'}</td>
        <td>${property.unit || 'N/A'}</td>
        <td>${property.area.toLocaleString()}</td>
        <td>${formattedPrice}</td>
        <td><span class="status-badge ${statusClass}">${property.status}</span></td>
        <td>${property.agent || 'N/A'}</td>
        <td>
            <button class="btn btn-primary btn-sm" onclick="editProperty('${property.id}')" title="Edit">
                <i class="fas fa-edit"></i>
            </button>
            <button class="btn btn-secondary btn-sm" onclick="viewProperty('${property.id}')" title="View">
                <i class="fas fa-eye"></i>
            </button>
            <button class="btn btn-danger btn-sm" onclick="deleteProperty('${property.id}')" title="Delete">
                <i class="fas fa-trash"></i>
            </button>
        </td>
    `;
    
    return row;
}

// Property Operations
function editProperty(propertyId) {
    const property = properties.find(p => p.id === propertyId);
    if (!property) {
        showNotification('Property not found', 'error');
        return;
    }
    
    // form tab switching 
    document.querySelector('.tab[onclick*="property-form"]').click();
    
    // Populate form
    populateForm(property);
    
    showNotification(`Editing property ${propertyId}`, 'info');
}

function populateForm(property) {
    Object.keys(property).forEach(key => {
        const element = document.getElementById(key === 'id' ? 'propertyId' : key);
        if (element) {
            element.value = property[key];
        }
    });
}

function viewProperty(propertyId) {
    const property = properties.find(p => p.id === propertyId);
    if (!property) {
        showNotification('Property not found', 'error');
        return;
    }
    
    const modalTitle = document.getElementById('modalTitle');
    const modalBody = document.getElementById('modalBody');
    
    if (modalTitle && modalBody) {
        modalTitle.textContent = `Property Details - ${property.id}`;
        modalBody.innerHTML = createPropertyDetailsHTML(property);
        showModal();
    }
}

function createPropertyDetailsHTML(property) {
    return `
        <div class="form-grid">
            <div class="form-group">
                <label>Property ID</label>
                <input type="text" class="form-control" value="${property.id}" readonly>
            </div>
            <div class="form-group">
                <label>Name</label>
                <input type="text" class="form-control" value="${property.name}" readonly>
            </div>
            <div class="form-group">
                <label>Project</label>
                <input type="text" class="form-control" value="${property.project}" readonly>
            </div>
            <div class="form-group">
                <label>Type</label>
                <input type="text" class="form-control" value="${property.type}" readonly>
            </div>
            <div class="form-group">
                <label>Area (Sq Ft)</label>
                <input type="text" class="form-control" value="${property.area.toLocaleString()}" readonly>
            </div>
            <div class="form-group">
                <label>Price</label>
                <input type="text" class="form-control" value="${formatCurrency(property.price)}" readonly>
            </div>
            <div class="form-group">
                <label>Status</label>
                <input type="text" class="form-control" value="${property.status}" readonly>
            </div>
            <div class="form-group">
                <label>Agent</label>
                <input type="text" class="form-control" value="${property.agent || 'N/A'}" readonly>
            </div>
        </div>
        <div class="btn-group">
            <button class="btn btn-primary" onclick="editProperty('${property.id}'); closeModal();">Edit Property</button>
            <button class="btn btn-secondary" onclick="closeModal()">Close</button>
        </div>
    `;
}

function deleteProperty(propertyId) {
    if (confirm('Are you sure you want to delete this property?')) {
        const index = properties.findIndex(p => p.id === propertyId);
        if (index !== -1) {
            properties.splice(index, 1);
            updateStats();
            renderPropertyTable();
            showNotification('Property deleted successfully', 'success');
        }
    }
}

// Filtering , Search
function filterProperties() {
    const searchTerm = document.getElementById('searchInput').value.toLowerCase();
    const statusFilter = document.getElementById('statusFilter') ? document.getElementById('statusFilter').value : '';
    const typeFilter = document.getElementById('typeFilter') ? document.getElementById('typeFilter').value : '';
    
    filteredProperties = properties.filter(property => {
        const matchesSearch = !searchTerm || 
            property.name.toLowerCase().includes(searchTerm) ||
            property.id.toLowerCase().includes(searchTerm) ||
            property.project.toLowerCase().includes(searchTerm);
            
        const matchesStatus = !statusFilter || property.status === statusFilter;
        const matchesType = !typeFilter || property.type.toLowerCase() === typeFilter;
        
        return matchesSearch && matchesStatus && matchesType;
    });
    
    renderPropertyTable();
}

function filterByStatus() {
    filterProperties();
}

function filterByType() {
    filterProperties();
}

// Bulk Operations
function toggleSelectAll() {
    const selectAll = document.getElementById('selectAll');
    const checkboxes = document.querySelectorAll('.property-select');
    
    checkboxes.forEach(checkbox => {
        checkbox.checked = selectAll.checked;
        togglePropertySelection(checkbox.dataset.id);
    });
}

function togglePropertySelection(propertyId) {
    const checkbox = document.querySelector(`[data-id="${propertyId}"]`);
    
    if (checkbox && checkbox.checked) {
        if (!selectedProperties.includes(propertyId)) {
            selectedProperties.push(propertyId);
        }
    } else {
        selectedProperties = selectedProperties.filter(id => id !== propertyId);
    }
    
    // Update select all checkbox
    const selectAll = document.getElementById('selectAll');
    const allCheckboxes = document.querySelectorAll('.property-select');
    const checkedBoxes = document.querySelectorAll('.property-select:checked');
    
    if (selectAll) {
        selectAll.checked = allCheckboxes.length === checkedBoxes.length;
        selectAll.indeterminate = checkedBoxes.length > 0 && checkedBoxes.length < allCheckboxes.length;
    }
}

function bulkEdit() {
    if (selectedProperties.length === 0) {
        showNotification('Please select properties to edit', 'warning');
        return;
    }
    
    showNotification(`Bulk editing ${selectedProperties.length} properties`, 'info');
}

function bulkDelete() {
    if (selectedProperties.length === 0) {
        showNotification('Please select properties to delete', 'warning');
        return;
    }
    
    if (confirm(`Are you sure you want to delete ${selectedProperties.length} properties?`)) {
        properties = properties.filter(p => !selectedProperties.includes(p.id));
        selectedProperties = [];
        updateStats();
        renderPropertyTable();
        showNotification('Selected properties deleted successfully', 'success');
    }
}

function bulkExport() {
    if (selectedProperties.length === 0) {
        showNotification('Please select properties to export', 'warning');
        return;
    }
    
    const selectedData = properties.filter(p => selectedProperties.includes(p.id));
    exportToCSV(selectedData, 'selected-properties.csv');
    showNotification('Selected properties exported successfully', 'success');
}

// Statistics Update
function updateStats() {
    const total = properties.length;
    const available = properties.filter(p => p.status === 'available').length;
    const reserved = properties.filter(p => p.status === 'reserved').length;
    const sold = properties.filter(p => p.status === 'sold').length;
    
    updateStatElement('totalProperties', total);
    updateStatElement('availableProperties', available);
    updateStatElement('reservedProperties', reserved);
    updateStatElement('soldProperties', sold);
}

function updateStatElement(elementId, value) {
    const element = document.getElementById(elementId);
    if (element) {
        element.textContent = value;
    }
}

// File Upload Handling
function initializeDragDrop() {
    const uploadZones = document.querySelectorAll('.upload-zone');
    
    uploadZones.forEach(zone => {
        zone.addEventListener('dragover', handleDragOver);
        zone.addEventListener('dragleave', handleDragLeave);
        zone.addEventListener('drop', handleDrop);
    });
}

function handleDragOver(e) {
    e.preventDefault();
    this.classList.add('drag-over');
}

function handleDragLeave(e) {
    e.preventDefault();
    this.classList.remove('drag-over');
}

function handleDrop(e) {
    e.preventDefault();
    this.classList.remove('drag-over');
    
    const files = e.dataTransfer.files;
    if (files.length > 0) {
        handleFileUpload({ files: files });
    }
}

function handleFileUpload(input) {
    const files = input.files;
    if (files && files[0]) {
        const file = files[0];
        const fileName = file.name;
        const fileSize = (file.size / 1024 / 1024).toFixed(2);
        
        showNotification(`File selected: ${fileName} (${fileSize} MB)`, 'success');
        
        // upload progress 
        showUploadProgress();
        
        // file processing 
        simulateFileProcessing(fileName);
    }
}

function showUploadProgress() {
    const progressEl = document.getElementById('uploadProgress');
    const progressFill = document.getElementById('progressFill');
    const progressText = document.getElementById('progressText');
    
    if (progressEl) {
        progressEl.style.display = 'block';
        
        let progress = 0;
        const interval = setInterval(() => {
            progress += Math.random() * 15;
            if (progress >= 100) {
                progress = 100;
                clearInterval(interval);
                
                setTimeout(() => {
                    progressEl.style.display = 'none';
                    showNotification('File uploaded and processed successfully!', 'success');
                }, 1000);
            }
            
            if (progressFill) progressFill.style.width = progress + '%';
            if (progressText) progressText.textContent = `Uploading... ${Math.round(progress)}%`;
        }, 200);
    }
}

function simulateFileProcessing(fileName) {
    // Simulate adding data from uploaded file
    const newProperty = {
        id: 'P' + String(properties.length + 1).padStart(3, '0'),
        name: `Property from ${fileName}`,
        project: 'Uploaded Project',
        type: 'Residential',
        building: 'Upload Building',
        area: 1000,
        price: 200000,
        status: 'available',
        agent: 'System Import'
    };
    
    setTimeout(() => {
        properties.push(newProperty);
        updateStats();
        renderPropertyTable();
    }, 2000);
}

// Export Functions
function exportList() {
    exportToCSV(properties, 'property-list.csv');
    showNotification('Property list exported successfully', 'success');
}

function exportToCSV(data, filename) {
    if (!data.length) return;
    
    const headers = ['ID', 'Name', 'Project', 'Type', 'Building', 'Unit', 'Area', 'Price', 'Status', 'Agent'];
    const csvContent = [
        headers.join(','),
        ...data.map(property => [
            property.id,
            `"${property.name}"`,
            `"${property.project}"`,
            property.type,
            `"${property.building || ''}"`,
            `"${property.unit || ''}"`,
            property.area,
            property.price,
            property.status,
            `"${property.agent || ''}"`
        ].join(','))
    ].join('
');
    
    downloadFile(csvContent, filename, 'text/csv');
}

function downloadFile(content, filename, contentType) {
    const blob = new Blob([content], { type: contentType });
    const url = URL.createObjectURL(blob);
    const link = document.createElement('a');
    
    link.href = url;
    link.download = filename;
    link.style.display = 'none';
    
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    
    URL.revokeObjectURL(url);
}

// Modal Functions
function showModal() {
    const modal = document.getElementById('modal');
    if (modal) {
        modal.classList.add('show');
    }
}

function closeModal() {
    const modal = document.getElementById('    
    initializeUploadZones();
    
    
    updateStats();
});

// Add property to storage
function addPropertyToStorage(propertyData) {
    const newProperty = {
        id: propertyData.propertyId,
        name: 
    </script>
</body>
</html>
